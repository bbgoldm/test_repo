"""
Generate Tuning CSV

Purpose:  This program will generate an MV and CV tuning CSV based on DMC CCF file

Initial Release: 12/06/2023, Brent Goldman

Quick Instructions:
--  Generate a CCF file from DMC Builder and copy into same directory as this program.
--  Run this application.  It will generate the TAGLIST_FILE (see CONSTANTS to rename).
"""

# Imports
import csv
import re
import xlsxwriter

# CONSTANTS
# <<<<<User needs to modify these>>>>
TUNING_FILE = 'LDU_DMCTuning.xlsx'                         # Program generated taglist file.  User should modify and save as FinalizedTagList.
CCF_FILE = 'LDU_CCF.ccf'                            # CCF file from DMC Builder

class CV_Object:
    """Create MV / CV Object"""
    def __init__(self, dmcTagName):
        self.dmcTagName = str(dmcTagName)
        self.measurementTag = None
        self.description = None
        self.dynamicHighLimitConcern = None
        self.dynamicHighLimitZone = None
        self.dynamicLowLimitConcern = None
        self.dynamicLowLimitZone = None
        self.dynamicTargetConcern = None
        self.eceInEngineeringUnits = None
        self.engineeringHighLimit = None
        self.engineeringLowLimit = None
        self.engineeringHighLimitJustification = None
        self.engineeringLowLimitJustification = None
        self.etParticipationSwitch = None
        self.isCritical = None
        self.lpCost = None
        self.maximumImbalances = None
        self.maximumSteadyStateCVStep = None
        self.operatorHighLimit = None
        self.operatorLowLimit = None
        self.predErrorFilterHorizon = None
        self.predErrorFilterLag = None
        self.predErrorFilterType = None
        self.rampHorizon = None
        self.rampRate = None
        self.rampSetpoint = None
        self.rampControllerShedOption = None
        self.rotationFactor = None
        self.ssHighLimitConcern = None
        self.ssHighLimitRank = None
        self.ssHighLimitRankTypeQP = None
        self.ssLowLimitConcern = None
        self.ssLowLimitRank = None
        self.ssLowLimitRankTypeQP = None
        self.ssTargetConcern = None
        self.ssTargetConcernLower = None
        self.ssTargetConcernUpper = None
        self.ssTargetRank = None
        self.ssTargetRankLower = None
        self.ssTargetRankUpper = None
        self.subcontrollerName = None
        self.units = None
        self.utag = None
        self.validityHighLimit = None
        self.validityLowLimit = None
    
    def createParameterList(self):
        """Create a list of parameters in preferred order"""
        parameterList = []
        parameterList.append(self.dmcTagName)
        parameterList.append(self.measurementTag)
        parameterList.append(self.description)
        parameterList.append(self.dynamicHighLimitConcern)
        parameterList.append(self.dynamicHighLimitZone)
        parameterList.append(self.dynamicLowLimitConcern)
        parameterList.append(self.dynamicLowLimitZone)
        parameterList.append(self.dynamicTargetConcern)
        parameterList.append(self.eceInEngineeringUnits)
        parameterList.append(self.engineeringHighLimit)
        parameterList.append(self.engineeringLowLimit)
        parameterList.append(self.engineeringHighLimitJustification)
        parameterList.append(self.engineeringLowLimitJustification)
        parameterList.append(self.etParticipationSwitch)
        parameterList.append(self.isCritical)
        parameterList.append(self.lpCost)
        parameterList.append(self.maximumImbalances)
        parameterList.append(self.maximumSteadyStateCVStep)
        parameterList.append(self.operatorHighLimit)
        parameterList.append(self.operatorLowLimit)
        parameterList.append(self.predErrorFilterHorizon)
        parameterList.append(self.predErrorFilterLag)
        parameterList.append(self.predErrorFilterType)
        parameterList.append(self.rampHorizon)
        parameterList.append(self.rampRate)
        parameterList.append(self.rampSetpoint)
        parameterList.append(self.rampControllerShedOption)
        parameterList.append(self.rotationFactor)
        parameterList.append(self.ssHighLimitConcern)
        parameterList.append(self.ssHighLimitRank)
        parameterList.append(self.ssHighLimitRankTypeQP)
        parameterList.append(self.ssLowLimitConcern)
        parameterList.append(self.ssLowLimitRank)
        parameterList.append(self.ssLowLimitRankTypeQP)
        parameterList.append(self.ssTargetConcern)
        parameterList.append(self.ssTargetConcernLower)
        parameterList.append(self.ssTargetConcernUpper)
        parameterList.append(self.ssTargetRank)
        parameterList.append(self.ssTargetRankLower)
        parameterList.append(self.ssTargetRankUpper)
        parameterList.append(self.subcontrollerName)
        parameterList.append(self.units)
        parameterList.append(self.utag)
        parameterList.append(self.validityHighLimit)
        parameterList.append(self.validityLowLimit)
        return parameterList
    
    def createParameterListNames(self):
        """Create list of parameter names in preferred order"""
        parameterListNames = []
        parameterListNames.append('DMC Tag Name')
        parameterListNames.append('Measurement Tag')
        parameterListNames.append('Description')
        parameterListNames.append('Dynamic High Limit Concern')
        parameterListNames.append('Dynamic High Limit Zone')
        parameterListNames.append('Dynamic Low Limit Concern')
        parameterListNames.append('Dynamic Low Limit Zone')
        parameterListNames.append('Dynamic Target Concern')
        parameterListNames.append('ECE in Engineering Units')
        parameterListNames.append('Engineering High Limit')
        parameterListNames.append('Engineering Low Limit')
        parameterListNames.append('Engineering High Limit Justification')
        parameterListNames.append('Engineering Low Limit Justification')
        parameterListNames.append('ET Participation Switch')
        parameterListNames.append('Is Critical')
        parameterListNames.append('LP Cost')
        parameterListNames.append('Maximum Imbalances')
        parameterListNames.append('Maximum Steady State CV Step')
        parameterListNames.append('Operator High Limit')
        parameterListNames.append('Operator Low Limit')
        parameterListNames.append('Pred Error Filter Horizon')
        parameterListNames.append('Pred Error Filter Lag')
        parameterListNames.append('Pred Error Filter Type')
        parameterListNames.append('Ramp Horizon')
        parameterListNames.append('Ramp Rate')
        parameterListNames.append('Ramp Setpoint')
        parameterListNames.append('Ramp Controller Shed Option')
        parameterListNames.append('Rotation Factor')
        parameterListNames.append('SS High Limit Concern')
        parameterListNames.append('SS High Limit Rank')
        parameterListNames.append('SS High Limit Rank Type QP')
        parameterListNames.append('SS Low Limit Concern')
        parameterListNames.append('SS Low Limit Rank')
        parameterListNames.append('SS Low Limit Rank Type QP')
        parameterListNames.append('SS Target Concern')
        parameterListNames.append('SS Target Concern Lower')
        parameterListNames.append('SS Target Concern Upper')
        parameterListNames.append('SS Target Rank')
        parameterListNames.append('SS Target Rank Lower')
        parameterListNames.append('SS Target Rank Upper')
        parameterListNames.append('Subcontroller Name')
        parameterListNames.append('Units')
        parameterListNames.append('Utag')
        parameterListNames.append('Validity High Limit')
        parameterListNames.append('Validity Low Limit')
        return parameterListNames


class MV_Object:
    """Create MV / CV Object"""
    def __init__(self, dmcTagName):
        self.dmcTagName = str(dmcTagName)
        self.measurementTag = None
        self.costRank = None
        self.description = None
        self.dynamicMinimumMovement = None
        self.engineeringHighLimit = None
        self.engineeringHighLimitJustification = None
        self.engineeringLowLimit = None
        self.engineeringLowLimitJustification = None
        self.etParticipationSwitch = None
        self.lpCost = None
        self.maximumMove = None
        self.moveSuppression = None
        self.operatorHighLimit = None
        self.operatorLowLimit = None
        self.ssMoveLimit = None
        self.ssTargetConcern = None
        self.ssTargetConcernLower = None
        self.ssTargetConcernUpper = None
        self.ssTargetRank = None
        self.ssTargetRankLower = None
        self.ssTargetRankUpper = None
        self.steadyStateMinMovement = None
        self.subcontrollerName = None
        self.units = None
        self.utag = None
        self.validityHighLimit = None
        self.validityLowLimit = None
    
    def createParameterList(self):
        """Create a list of parameters in preferred order"""
        parameterList = []
        parameterList.append(self.dmcTagName)
        parameterList.append(self.measurementTag)
        parameterList.append(self.costRank)
        parameterList.append(self.description)
        parameterList.append(self.dynamicMinimumMovement)
        parameterList.append(self.engineeringHighLimit)
        parameterList.append(self.engineeringHighLimitJustification)
        parameterList.append(self.engineeringLowLimit)
        parameterList.append(self.engineeringLowLimitJustification)
        parameterList.append(self.etParticipationSwitch)
        parameterList.append(self.lpCost)
        parameterList.append(self.maximumMove)
        parameterList.append(self.moveSuppression)
        parameterList.append(self.operatorHighLimit)
        parameterList.append(self.operatorLowLimit)
        parameterList.append(self.ssMoveLimit)
        parameterList.append(self.ssTargetConcern)
        parameterList.append(self.ssTargetConcernLower)
        parameterList.append(self.ssTargetConcernUpper)
        parameterList.append(self.ssTargetRank)
        parameterList.append(self.ssTargetRankLower)
        parameterList.append(self.ssTargetRankUpper)
        parameterList.append(self.steadyStateMinMovement)
        parameterList.append(self.subcontrollerName)
        parameterList.append(self.units)
        parameterList.append(self.utag)
        parameterList.append(self.validityHighLimit)
        parameterList.append(self.validityLowLimit)
        return parameterList
    
    def createParameterListNames(self):
        """Create list of parameter names in preferred order"""
        parameterListNames = []
        parameterListNames.append('DMC Tag Name')
        parameterListNames.append('Measurement Tag')
        parameterListNames.append('Cost Rank')
        parameterListNames.append('Description')
        parameterListNames.append('Dynamic Minimum Movement')
        parameterListNames.append('Engineering High Limit')
        parameterListNames.append('Engineering High Limit Justification')
        parameterListNames.append('Engineering Low Limit')
        parameterListNames.append('Engineering Low Limit Justification')
        parameterListNames.append('ET Participation Switch')
        parameterListNames.append('LP Cost')
        parameterListNames.append('Maximum Move')
        parameterListNames.append('Move Suppression')
        parameterListNames.append('Operator High Limit')
        parameterListNames.append('Operator Low Limit')
        parameterListNames.append('SS Move Limit')
        parameterListNames.append('SS Target Concern')
        parameterListNames.append('SS Target Concern Lower')
        parameterListNames.append('SS Target Concern Upper')
        parameterListNames.append('SS Target Rank')
        parameterListNames.append('SS Target Rank Lower')
        parameterListNames.append('SS Target Rank Upper')
        parameterListNames.append('Steady State Min Movement')
        parameterListNames.append('Subcontroller Name')
        parameterListNames.append('Units')
        parameterListNames.append('Utag')
        parameterListNames.append('Validity High Limit')
        parameterListNames.append('Validity Low Limit')
        return parameterListNames

# Functions
def main():
    """Entry point into code"""
    print("Begin building taglist...")
    MVobjectList, CVObjectList = build_objects(TUNING_FILE)  
    print("Begin writing taglist to file...")
    FullObjectList = MVobjectList + CVObjectList
    write_tags_excel(FullObjectList, TUNING_FILE)
    print(str(TUNING_FILE) + " file generated.")
    print("All done!")

def build_objects(output_file):
    """Build MV and CV Objects"""
    MVObjectList = []
    CVObjectList = []
    new_object = None  # MV Object
    with open(CCF_FILE, 'r') as file:
        for row in file:
            row = row.strip()
            if ('[IND:' in row):
                dmcTagName = row.split(':')[1].replace("]","")
                new_object = MV_Object(dmcTagName)
                MVObjectList.append(new_object)
            elif ('[DEP:' in row):
                dmcTagName = row.split(':')[1].replace("]","")
                new_object = CV_Object(dmcTagName)
                CVObjectList.append(new_object)
            #-----------------------------------------------------
            # CV Objects Parameters
            #-----------------------------------------------------
            # Description (Dep), DESCDEP
            elif ('.DESCDEP~' in row):
                new_object.description = row.split('~~~')[3]
            # DynamicHighLimitConcern (Dep), ECECMU
            elif ('.ECECMU~' in row):
                new_object.dynamicHighLimitConcern = row.split('~~~')[3]
            # DynamicHighLimitZone (Dep), TRANZU
            elif ('.TRANZU~' in row):
                new_object.dynamicHighLimitZone = row.split('~~~')[3]
            # DynamicLowLimitConcern (Dep), ECECML
            elif ('.ECECML~' in row):
                new_object.dynamicLowLimitConcern = row.split('~~~')[3]
            # DynamicLowLimitZone (Dep), TRANZL
            elif ('.TRANZL~' in row):
                new_object.dynamicLowLimitZone = row.split('~~~')[3]
            # DynamicTargetConcern (Dep), ECECMM
            elif ('.ECECMM~' in row):
                new_object.dynamicTargetConcern = row.split('~~~')[3]
            # ECEsInEngineeringUnits (Dep), XFRMECEC
            elif ('.XFRMECEC~' in row):
                new_object.eceInEngineeringUnits = row.split('~~~')[3]
            # EngineeringHighLimit (Dep), UDPENG
            elif ('.UDPENG~' in row):
                new_object.engineeringHighLimit = row.split('~~~')[3]
            # EngineeringLowLimit (Dep), LDPENG
            elif ('.LDPENG~' in row):
                new_object.engineeringLowLimit = row.split('~~~')[3]
            # EngineeringHighLimitJustification (Dep), UDPENGJ
            elif ('.UDPENGJ~' in row):
                new_object.engineeringHighLimitJustification = row.split('~~~')[3]
            # EngineeringLowLimitJustification (Dep), LDPENGJ
            elif ('.LDPENGJ~' in row):
                new_object.engineeringLowLimitJustification = row.split('~~~')[3]
            # ETParticipationSwitch (Dep), ETCSWC
            elif ('.ETCSWC~' in row):
                new_object.etParticipationSwitch = row.split('~~~')[3]
            # IsCritical (Dep), CRIDEP
            elif ('.CRIDEP~' in row):
                new_object.isCritical = row.split('~~~')[3]
            # LPCost (Dep), CVCST
            elif ('.CVCST~' in row):
                new_object.lpCost = row.split('~~~')[3]
            # MaximumImbalances (Dep), MXNIMB
            elif ('.MXNIMB~' in row):
                new_object.maximumImbalances = row.split('~~~')[3]
            # MaximumSteadyStateCVStep (Dep), CVSTEP
            elif ('.CVSTEP~' in row):
                new_object.maximumSteadyStateCVStep = row.split('~~~')[3]
            # OperatorHighLimit (Dep), UDEPTG
            elif ('.UDEPTG~' in row):
                new_object.operatorHighLimit = row.split('~~~')[3]
            # OperatorLowLimit (Dep), LDEPTG
            elif ('.LDEPTG~' in row):
                new_object.operatorLowLimit = row.split('~~~')[3]
            # PredErrorFilterHorizon (Dep), PRERHORIZ
            elif ('.PRERHORIZ~' in row):
                new_object.predErrorFilterHorizon = row.split('~~~')[3]
            # PredErrorFilterLag (Dep), PRERTAU
            elif ('.PRERTAU~' in row):
                new_object.predErrorFilterLag = row.split('~~~')[3]
            # PredErrorFilterType (Dep), PRERTYPE
            elif ('.PRERTYPE~' in row):
                new_object.predErrorFilterType = row.split('~~~')[3]
            # RampHorizon (Dep)  not in DMCPlus
            elif ('.RAMP_HORIZON~' in row):
                new_object.rampHorizon = row.split('~~~')[3]
            # RampRate (Dep), RAMPRT
            elif ('.RAMPRT~' in row):
                new_object.rampRate = row.split('~~~')[3]
            # RampSetpoint (Dep), RAMPSP
            elif ('.RAMPSP~' in row):
                new_object.rampSetpoint = row.split('~~~')[3]
            # RampControllerShedOption (Dep), RSHEDSUB
            elif ('.RSHEDSUB~' in row):
                new_object.rampControllerShedOption = row.split('~~~')[3]
            # RotationFactor (Dep), ROTFAC
            elif ('.ROTFAC~' in row):
                new_object.rotationFactor = row.split('~~~')[3]
            # SSHighLimitConcern (Dep), ECELPU
            elif ('.ECELPU~' in row):
                new_object.ssHighLimitConcern = row.split('~~~')[3]
            # SSHighLimitRank (Dep), CVRANKU
            elif ('.CVRANKU~' in row):
                new_object.ssHighLimitRank = row.split('~~~')[3]
            # SSHighLimitRankTypeQP (Dep), CVLPQU
            elif ('.CVLPQU~' in row):
                new_object.ssHighLimitRankTypeQP = row.split('~~~')[3]
            # SSLowLimitConcern (Dep), ECELPL
            elif ('.ECELPL~' in row):
                new_object.ssLowLimitConcern = row.split('~~~')[3]
            # SSLowLimitRank (Dep), CVRANKL
            elif ('.CVRANKL~' in row):
                new_object.ssLowLimitRank = row.split('~~~')[3]
            # SSLowLimitRankTypeQP (Dep), CVLPQL
            elif ('.CVLPQL~' in row):
                new_object.ssLowLimitRankTypeQP = row.split('~~~')[3]
            # SSTargetConcern (Dep), not in DMCPlus
            elif ('.SSTargetConcern~' in row):
                new_object.ssTargetConcern = row.split('~~~')[3]
            # SSTargetConcernLower (Dep), ETCECEL
            elif ('.ETCECEL~' in row):
                new_object.ssTargetConcernLower = row.split('~~~')[3]
            # SSTargetConcernUpper (Dep), ETCECEU
            elif ('.ETCECEU~' in row):
                new_object.ssTargetConcernUpper = row.split('~~~')[3]
            # SSTargetRank (Dep), not in DMCPlus
            elif ('.SSTargetRank~' in row):
                new_object.ssTargetRank = row.split('~~~')[3]
            # SSTargetRankLower (Dep), ETCRL
            elif ('.ETCRL~' in row):
                new_object.ssTargetRankLower = row.split('~~~')[3]
            # SSTargerRankUpper (Dep), ETCRU
            elif ('.ETCRU~' in row):
                new_object.ssTargetRankUpper = row.split('~~~')[3]
            # SubcontrollerName (Dep), CVINSB
            elif ('.CVINSB~' in row):
                new_object.subcontrollerName = row.split('~~~')[3]
            # Units (Dep), ENGDEP
            elif ('.ENGDEP~' in row):
                new_object.units = row.split('~~~')[3]
            # ValidityHighLimit (Dep), UVLDEP
            elif ('.UVLDEP~' in row):
                new_object.validityHighLimit = row.split('~~~')[3]
            # ValidityLowLimit (Dep), LVLDEP
            elif ('.LVLDEP~' in row):
                new_object.validityLowLimit = row.split('~~~')[3]
            #-----------------------------------------------------
            # MV Objects Parameters
            #-----------------------------------------------------
            # CostRank (Ind), CSTRANK
            elif ('.CSTRANK~' in row):
                new_object.costRank = row.split('~~~')[3]
            # Desription (Ind), DESCIND
            elif ('.DESCIND~' in row):
                new_object.description = row.split('~~~')[3]
            # DynamicMinimumMovement (Ind), DMINMOV
            elif ('.DMINMOV~' in row):
                new_object.dynamicMinimumMovement = row.split('~~~')[3]
            # EngineeringHighLimit (Ind), UMVENG
            elif ('.UMVENG~' in row):
                new_object.engineeringHighLimit = row.split('~~~')[3]
            # EngineeringHighLimitJustification (Ind), UMVENGJ
            elif ('.UMVENGJ~' in row):
                new_object.engineeringHighLimitJustification = row.split('~~~')[3]
            # EngineeringLowLimit (Ind), LMVENG
            elif ('.LMVENG~' in row):
                new_object.engineeringLowLimit = row.split('~~~')[3]
            # EngineeringLowLimitJustification (Ind), MVENGJ
            elif ('.MVENGJ~' in row):
                new_object.engineeringLowLimitJustification = row.split('~~~')[3]
            # ETParticipationSwitch (Ind), ETMSWC
            elif ('.ETMSWC~' in row):
                new_object.etParticipationSwitch = row.split('~~~')[3]
            # LPCost (Ind), CST
            elif ('.CST~' in row):
                new_object.lpCost = row.split('~~~')[3]
            # MaximumMove (Ind), MAXMOV
            elif ('.MAXMOV~' in row):
                new_object.maximumMove = row.split('~~~')[3]
            # MoveSuppression (Ind), SUPMOV
            elif ('.SUPMOV~' in row):
                new_object.moveSuppression = row.split('~~~')[3]
            # OperatorHighLimit (Ind), ULINDM
            elif ('.ULINDM~' in row):
                new_object.operatorHighLimit = row.split('~~~')[3]
            # OperatorLowLimit (Ind), LLINDM
            elif ('.LLINDM~' in row):
                new_object.operatorLowLimit = row.split('~~~')[3]
            # SSMoveLimit (ind), SSSTEP
            elif ('.SSSTEP~' in row):
                new_object.ssMoveLimit = row.split('~~~')[3]
            # SSTargetConcern (Ind) -- not in dmcplus
            elif ('.SSTargetConcern~' in row):
                new_object.ssTargetConcern = row.split('~~~')[3]
            # SSTargetConcernLower (Ind), ETMECEL
            elif ('.ETMECEL~' in row):
                new_object.ssTargetConcernLower = row.split('~~~')[3]
            # SSTargetConcernUpper (Ind), ETMECEU
            elif ('.ETMECEU~' in row):
                new_object.ssTargetConcernUpper = row.split('~~~')[3]
            # SSTargetRank -- not in dmcplus            
            # SSTargetRankLower (Ind), ETMRL
            elif ('.ETMRL~' in row):
                new_object.ssTargetRankLower = row.split('~~~')[3]
            # SSTargetRankUpper (ind), ETMRU
            elif ('.ETMRU~' in row):
                new_object.ssTargetRankUpper = row.split('~~~')[3]
            # SteadyStateMinMovement (Ind), LPCRIT
            elif ('.LPCRIT~' in row):
                new_object.steadyStateMinMovement = row.split('~~~')[3]
            # SubcontrollerName (Ind), MVINSB
            elif ('.MVINSB~' in row):
                new_object.subcontrollerName = row.split('~~~')[3]
            # Units (Ind), ENGIND
            elif ('.ENGIND~' in row):
                new_object.units = row.split('~~~')[3]
            # ValidityHighLimit (Ind), UVLIND
            elif ('.UVLIND~' in row):
                new_object.validityHighLimit = row.split('~~~')[3]
            # ValidityLowLimit (ind), LVLIND
            elif ('.LVLIND~' in row):
                new_object.validityLowLimit = row.split('~~~')[3]
            # -------------------------------------------
            # Other Parameters
            # -------------------------------------------
            # Utag
            if ".INDSTA~" in row or ".UDEPTG~" in row:
                # Utag encountered
                double_colon_index = row.find('::')
                period_index = row.find('.', double_colon_index)
                # quote_index = row.find('"')
                utag = row[double_colon_index + 3:period_index].strip()
                new_object.utag = utag
            # MeasurementTag (Ind)
            if ('.VIND~' in row or '.AUGCOP~' in row):
                tag_parameter = re.findall(r'::"([^"]+)"',row)
                if len(tag_parameter) > 0:
                    new_object.measurementTag = tag_parameter[0]
            # MeasurementTag (Dep)
            if ('.DEP~' in row):
                tag_parameter = re.findall(r'::"([^"]+)"',row)
                if len(tag_parameter) > 0:
                    new_object.measurementTag = tag_parameter[0]

    return MVObjectList, CVObjectList

def write_tags_excel(tags, output_file):
    """Write out MV and CV tags to Excel in different worksheets"""
    # Write the tags to Excel
    workbook = xlsxwriter.Workbook(output_file)
    worksheet1 = workbook.add_worksheet('MV')
    worksheet2 = workbook.add_worksheet('CV')
    
    # Write out MV Parameter List Names
    for i, parameter in enumerate(tags[0].createParameterListNames()):
        worksheet1.write(0, i, parameter)

    # Write out CV Parameter List Names
    for i, parameter in enumerate(tags[0].createParameterListNames()):
        worksheet2.write(0, i, parameter)

    mv_row = 0
    cv_row = 0
    for tag in tags:
        if isinstance(tag, MV_Object):
            mv_row += 1
            # Write out MV Parameters
            for i, parameter in enumerate(tag.createParameterList()):
                worksheet1.write(mv_row, i, parameter)
        elif isinstance(tag, CV_Object):
            cv_row += 1
            # Write out CV Parameters
            for i, parameter in enumerate(tag.createParameterList()):
                worksheet2.write(cv_row, i, parameter)
    workbook.close()


if __name__ == '__main__':
    main()
